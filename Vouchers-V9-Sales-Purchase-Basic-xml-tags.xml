<!-- These XML tags are added to Excel sheet at run-time by UDIMAGIC  -->
<XMLTAGS CELLREFERENCE="A1" FROMROW="3" xmlns:UDF="TallyUDF">
  <!-- Specifies that this (i.e Column as mentioned above) is the key field -->
  <COLUMNNAME.LIST>
    <COLUMNNAME>ID</COLUMNNAME>
    <COLUMNNAME>NAME</COLUMNNAME>
  </COLUMNNAME.LIST>
  <!-- Create VOUCHERTYPE Master -->
  <MASTER TYPE="VOUCHERTYPE">
    <NAME.LIST TYPE="String">
      <NAME COLUMNREFERENCE="C"/>
    </NAME.LIST>
    <PARENT COLUMNREFERENCE="B"/>
    <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;No&quot;,&quot;Yes&quot;)"/>
    <NUMBERINGMETHOD>Manual</NUMBERINGMETHOD>
  </MASTER>
  <!-- Create  Sales/Purchase Ledger Master -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME FORMULA="=if(len(trim(AB#))&gt;0,AB#,if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;debit note&quot;),&quot;PURCHASE &quot;,&quot;SALES &quot;) &amp; (V#+X#+Z#) &amp; &quot;%&quot;)"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;debit note&quot;),&quot;Purchase Accounts&quot;,&quot;Sales Accounts&quot;)"/>
    <TAXTYPE>Others</TAXTYPE>
    <ISBILLWISEON>No</ISBILLWISEON>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <AFFECTSSTOCK FORMULA="=if(And(len(trim(K#))=0,len(trim(L#))=0),&quot;No&quot;,&quot;Yes&quot;)"/>
    <USEFORVAT>No</USEFORVAT>
    <GSTAPPLICABLE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
    <!-- Type of supply : Goods or Services -->
    <GSTTYPEOFSUPPLY SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=if(And(len(trim(K#))=0,len(trim(L#))=0),&quot;Services&quot;,&quot;Goods&quot;)"/>
  </MASTER>
  <!-- Create Party LEDGER Masters -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME COLUMNREFERENCE="H"/>
    </NAME.LIST>
    <PARENT FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;debit note&quot;),&quot;Sundry Creditors&quot;,&quot;Sundry Debtors&quot;)"/>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <ADDITIONALNAME COLUMNREFERENCE="H"/>
    <ISBILLWISEON>Yes</ISBILLWISEON>
    <!-- GST fields for PARTY LEDGER -->
    <GSTREGISTRATIONTYPE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=if(len(trim(I#))=0,&quot;Unregistered&quot;,&quot;Regular&quot;)"/>
    <!-- GSTIN / UIN -->
    <PARTYGSTIN SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=trim(I#)"/>
    <COUNTRYNAME SKIP="=len(trim(J#))=0">India</COUNTRYNAME>
    <!-- 2017-09-14: STATENAME is converted to proper-case  -->
    <STATENAME FORMULA="=proper(trim(J#))"/>
    <LEDSTATENAME FORMULA="=proper(trim(J#))"/>
  </MASTER>
  <!-- Create Trade discount Master -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME FORMULA="=if(len(trim(U#))=0,&quot;Discount&quot;,U#)"/>
    </NAME.LIST>
    <PARENT>Indirect Expenses</PARENT>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <GSTAPPLICABLE FORMULA="=&quot;~[~ Not Applicable&quot;"/>
    <UDF:VATDEALERNATURE.LIST DESC="`VATDealerNature`" ISLIST="YES" TYPE="String" INDEX="10031">
      <UDF:VATDEALERNATURE DESC="`VATDealerNature`">Discount</UDF:VATDEALERNATURE>
    </UDF:VATDEALERNATURE.LIST>
  </MASTER>
  <!-- Create IGST TAX LEDGER Master -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME FORMULA="=if(len(trim(AC#))&gt;0,AC#,if(Or(IsError(Round(V#,2)),len(trim(V#))=0,V#=0),&quot;&quot;,&quot;IGST &quot; &amp; V# &amp; &quot;%&quot;))"/>
    </NAME.LIST>
    <PARENT>Duties &amp; Taxes</PARENT>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <GSTAPPLICABLE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
    <GSTDUTYHEAD SKIP="=trim(AH#)=&quot;yes&quot;">Integrated Tax</GSTDUTYHEAD>
    <TAXTYPE SKIP="=trim(AH#)=&quot;yes&quot;">GST</TAXTYPE>
    <!-- <RATEOFTAXCALCULATION COLUMNREFERENCE="V"/> -->
  </MASTER>
  <!-- Create CGST TAX LEDGER Master -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME FORMULA="=if(len(trim(AD#))&gt;0,AD#,if(Or(IsError(Round(X#,2)),len(trim(X#))=0,X#=0),&quot;&quot;,&quot;CGST &quot; &amp; X# &amp; &quot;%&quot;))"/>
    </NAME.LIST>
    <PARENT>Duties &amp; Taxes</PARENT>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <GSTAPPLICABLE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
    <GSTDUTYHEAD SKIP="=trim(AH#)=&quot;yes&quot;">Central Tax</GSTDUTYHEAD>
    <TAXTYPE SKIP="=trim(AH#)=&quot;yes&quot;">GST</TAXTYPE>
    <!-- <RATEOFTAXCALCULATION COLUMNREFERENCE="X"/> -->
  </MASTER>
  <!-- Create SGST TAX LEDGER Master -->
  <MASTER TYPE="LEDGER">
    <NAME.LIST>
      <NAME FORMULA="=if(len(trim(AE#))&gt;0,AE#,if(Or(IsError(Round(Z#,2)),len(trim(Z#))=0,Z#=0),&quot;&quot;,&quot;SGST &quot; &amp; Z# &amp; &quot;%&quot;))"/>
    </NAME.LIST>
    <PARENT>Duties &amp; Taxes</PARENT>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
    <AFFECTSSTOCK>No</AFFECTSSTOCK>
    <GSTAPPLICABLE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
    <GSTDUTYHEAD SKIP="=trim(AH#)=&quot;yes&quot;">State Tax</GSTDUTYHEAD>
    <TAXTYPE SKIP="=trim(AH#)=&quot;yes&quot;">GST</TAXTYPE>
    <!-- <RATEOFTAXCALCULATION COLUMNREFERENCE="Z"/> -->
  </MASTER>
  <!-- Create a single LEDGER Master -->
  <MASTER TYPE="LEDGER" SINGLERECORD="Yes">
    <NAME.LIST>
      <NAME>Round Off</NAME>
    </NAME.LIST>
    <PARENT>Indirect Expenses</PARENT>
    <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
  </MASTER>
  <!-- Create UNIT Master -->
  <MASTER TYPE="UNIT">
    <NAME COLUMNREFERENCE="N"/>
    <ISSIMPLEUNIT>Yes</ISSIMPLEUNIT>
    <GSTREPUOM SKIP="=Not(trim(N#)=&quot;nos&quot;)">NOS-NUMBERS</GSTREPUOM>
    <GSTREPUOM SKIP="=Not(trim(N#)=&quot;kgs&quot;)">KGS-KILOGRAMS</GSTREPUOM>
  </MASTER>
  <!-- Create STOCKITEM Masters -->
  <MASTER TYPE="STOCKITEM">
    <OLDNAME FORMULA="=if(len(trim(L#))=0,K#,L#)"/>
    <!-- Create new item with Name or PartNo -->
    <NAME FORMULA="=if(len(trim(K#))=0,L#,K#)"/>
    <!-- SKIP if both Name and Part No are empty -->
    <ADDITIONALNAME SKIP="=Or(len(trim(L#))=0,len(trim(K#))=0)" COLUMNREFERENCE="L"/>
    <PARENT/>
    <BASEUNITS COLUMNREFERENCE="N"/>
    <!-- GST details -->
    <GSTAPPLICABLE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=&quot;~[~ Applicable&quot;"/>
    <!-- Type of supply -->
    <GSTTYPEOFSUPPLY SKIP="=trim(AH#)=&quot;yes&quot;">Goods</GSTTYPEOFSUPPLY>
    <GSTDETAILS.LIST SKIP="=trim(AH#)=&quot;yes&quot;">
      <APPLICABLEFROM>20170701</APPLICABLEFROM>
      <CALCULATIONTYPE>On Value</CALCULATIONTYPE>
      <HSNCODE COLUMNREFERENCE="M"/>
      <TAXABILITY FORMULA="=If(Round(V#+X#+Z#,2)&gt;0,&quot;Taxable&quot;,&quot;Exempt&quot;)"/>
      <STATEWISEDETAILS.LIST>
        <STATENAME>~[~ Any</STATENAME>
        <RATEDETAILS.LIST>
          <GSTRATEDUTYHEAD>Central Tax</GSTRATEDUTYHEAD>
          <GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
          <GSTRATE FORMULA="=If(Round(X#,2)&gt;0,Round(X#,2),If(V#&gt;0,Round(V#/2,2),0))"/>
        </RATEDETAILS.LIST>
        <RATEDETAILS.LIST>
          <GSTRATEDUTYHEAD>State Tax</GSTRATEDUTYHEAD>
          <GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
          <GSTRATE FORMULA="=If(Round(Z#,2)&gt;0,Round(Z#,2),If(V#&gt;0,Round(V#/2,2),0))"/>
        </RATEDETAILS.LIST>
        <RATEDETAILS.LIST>
          <GSTRATEDUTYHEAD>Integrated Tax</GSTRATEDUTYHEAD>
          <GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
          <GSTRATE FORMULA="=If(Round(V#,2)&gt;0,Round(V#,2),Round(X#+Z#,2))"/>
        </RATEDETAILS.LIST>
        <RATEDETAILS.LIST>
          <GSTRATEDUTYHEAD>Cess</GSTRATEDUTYHEAD>
          <GSTRATEVALUATIONTYPE>Based on Value</GSTRATEVALUATIONTYPE>
          <!-- Hard coded -->
          <GSTRATE>0</GSTRATE>
        </RATEDETAILS.LIST>
      </STATEWISEDETAILS.LIST>
      <TEMPGSTDETAILSLABRATES.LIST>
      </TEMPGSTDETAILSLABRATES.LIST>
    </GSTDETAILS.LIST>
  </MASTER>
  <VOUCHER9>
    <GUID FORMULA="=+&quot;udi-HZ3K9T-&quot; &amp; A# &amp; &quot;-&quot; &amp; C# &amp; &quot;-&quot; &amp; E#"/>
    <DATE COLUMNREFERENCE="E"/>
    <EFFECTIVEDATE COLUMNREFERENCE="E"/>
    <VOUCHERTYPENAME COLUMNREFERENCE="C"/>
    <VOUCHERNUMBER COLUMNREFERENCE="D"/>
    <REFERENCE COLUMNREFERENCE="F"/>
    <NARRATION COLUMNREFERENCE="AF"/>
    <ISINVOICE>Yes</ISINVOICE>
    <PERSISTEDVIEW FORMULA="=if(And(len(trim(K#))=0,len(trim(L#))=0),&quot;Accounting Voucher View&quot;,&quot;Invoice Voucher View&quot;)"/>
    <!-- For Purchase -->
    <UDF:REFERENCEDATE.LIST DESC="`ReferenceDate`" ISLIST="YES" TYPE="Date">
      <UDF:REFERENCEDATE DESC="`ReferenceDate`" COLUMNREFERENCE="G"/>
    </UDF:REFERENCEDATE.LIST>
    <REFERENCEDATE COLUMNREFERENCE="G"/>
    <!-- GSTIN / UIN -->
    <PARTYGSTIN SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=trim(I#)"/>
    <!-- For compatibility with Tally ERP 9 Release 6.1.1 - Cash Purchase entry -->
    <GSTREGISTRATIONTYPE SKIP="=trim(AH#)=&quot;yes&quot;" FORMULA="=if(len(trim(I#))=0,&quot;Unregistered&quot;,&quot;Regular&quot;)"/>
    <!-- 2017-09-14: STATENAME is converted to proper-case  -->
    <STATENAME FORMULA="=proper(trim(J#))"/>
    <PARTYNAME COLUMNREFERENCE="H"/>
    <PARTYLEDGERNAME COLUMNREFERENCE="H"/>
    <BASICBASEPARTYNAME COLUMNREFERENCE="H"/>
    <BASICBUYERNAME COLUMNREFERENCE="H"/>
    <!-- Other GST details -->
    <VATPARTYTRANSRETURNNUMBER SKIP="=trim(AH#)=&quot;yes&quot;" COLUMNREFERENCE="F"/>
    <VATPARTYTRANSRETURNDATE SKIP="=trim(AH#)=&quot;yes&quot;" COLUMNREFERENCE="G"/>
    <GSTNATUREOFRETURN SKIP="=IsError(Match(trim(B#[1]),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))">01-Sales Return</GSTNATUREOFRETURN>
    <!-- Hard coded -->
    <URDORIGINALSALEVALUE SKIP="=IsError(Match(trim(B#[1]),\123&quot;credit note&quot;,&quot;debit note&quot;\125,0))">Lesser than or equal to 2.5 lakhs</URDORIGINALSALEVALUE>

    <!-- Party Ledger -->
    <LEDGERENTRIES.LIST ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME COLUMNREFERENCE="H"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;No&quot;,&quot;Yes&quot;)"/>
      <AMOUNT FORMULA="=Round({Round(R#,2)-Round(T#,2)+Round(W#,2)+Round(Y#,2)+Round(AA#,2)},if(trim(AG#)=&quot;yes&quot;,0,2))*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),1,-1)"/>
      <BILLALLOCATIONS.LIST SKIP="=Len(trim(D#))=0">
        <NAME COLUMNREFERENCE="D"/>
        <BILLTYPE>New Ref</BILLTYPE>
        <AMOUNT FORMULA="=Round({Round(R#,2)-Round(T#,2)+Round(W#,2)+Round(Y#,2)+Round(AA#,2)},if(trim(AG#)=&quot;yes&quot;,0,2))*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),1,-1)"/>
      </BILLALLOCATIONS.LIST>
    </LEDGERENTRIES.LIST>
    <!-- Sales/Purchase Ledger -->
    <LEDGERENTRIES.LIST GROUPBY="=if(len(trim(AB#))=0,if(Round(V#,2)=0,Round(X#,2),Round(V#,2)),trim(AB#))" SCROLL="YES" SKIP="=Not(And(len(trim(K#))=0,len(trim(L#))=0))" ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME FORMULA="=if(len(trim(AB#))&gt;0,AB#,if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;debit note&quot;),&quot;PURCHASE &quot;,&quot;SALES &quot;) &amp; (V#+X#+Z#) &amp; &quot;%&quot;)"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(R#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
    </LEDGERENTRIES.LIST>
    <!-- Trade discount Ledger -->
    <LEDGERENTRIES.LIST SKIP="={Round(T#,2)}=0" ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME FORMULA="=if(len(trim(U#))=0,&quot;Discount&quot;,U#)"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(T#,2)}*if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),1,-1)"/>
    </LEDGERENTRIES.LIST>
    <!-- IGST Ledger -->
    <LEDGERENTRIES.LIST GROUPBY="=if(len(trim(AC#))=0,trim(V#),trim(AC#))" SKIP="={Round(W#,2)}=0" ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME FORMULA="=if(len(trim(AC#))&gt;0,AC#,if(Or(IsError(Round(V#,2)),len(trim(V#))=0,V#=0),&quot;&quot;,&quot;IGST &quot; &amp; V# &amp; &quot;%&quot;))"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(W#,2)}*if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
    </LEDGERENTRIES.LIST>
    <!-- CGST Ledger -->
    <LEDGERENTRIES.LIST GROUPBY="=if(len(trim(AD#))=0,trim(X#),trim(AD#))" SKIP="={Round(Y#,2)}=0" ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME FORMULA="=if(len(trim(AD#))&gt;0,AD#,if(Or(IsError(Round(X#,2)),len(trim(X#))=0,X#=0),&quot;&quot;,&quot;CGST &quot; &amp; X# &amp; &quot;%&quot;))"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(Y#,2)}*if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
    </LEDGERENTRIES.LIST>
    <!-- SGST Ledger -->
    <LEDGERENTRIES.LIST GROUPBY="=if(len(trim(AE#))=0,trim(Z#),trim(AE#))" SKIP="={Round(AA#,2)}=0" ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME FORMULA="=if(len(trim(AE#))&gt;0,AE#,if(Or(IsError(Round(Z#,2)),len(trim(Z#))=0,Z#=0),&quot;&quot;,&quot;SGST &quot; &amp; Z# &amp; &quot;%&quot;))"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="={Round(AA#,2)}*if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),-1,1)"/>
    </LEDGERENTRIES.LIST>
    <!-- Round Off Ledger -->
    <LEDGERENTRIES.LIST SKIP="=Or(Not(trim(AG#)=&quot;yes&quot;),Round(Round({Round(R#,2)-Round(T#,2)+Round(W#,2)+Round(Y#,2)+Round(AA#,2)},0)-Round({Round(R#,2)-Round(T#,2)+Round(W#,2)+Round(Y#,2)+Round(AA#,2)},2),2)=0)" ALTERNATETAGNAME="=if(len(trim(K#[1]))=0,&quot;ALLLEDGERENTRIES.LIST&quot;,&quot;&quot;)">
      <LEDGERNAME>Round Off</LEDGERNAME>
      <ISDEEMEDPOSITIVE FORMULA="=if(Not(IsError(Match(trim(B#[1]),\123&quot;purchase&quot;,&quot;purchase order&quot;,&quot;receipt note&quot;,&quot;credit note&quot;\125,0))),&quot;Yes&quot;,&quot;No&quot;)"/>
      <AMOUNT FORMULA="=Round(Round({Round(R#,2)-Round(T#,2)+Round(W#,2)+Round(Y#,2)+Round(AA#,2)},0)-Round({Round(R#,2)-Round(T#,2)+Round(W#,2)+Round(Y#,2)+Round(AA#,2)},2),2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
    </LEDGERENTRIES.LIST>
    <!-- StockItems -->
    <ALLINVENTORYENTRIES.LIST SCROLL="YES" SKIP="=And(len(trim(K#))=0,len(trim(L#))=0)">
      <STOCKITEMNAME FORMULA="=if(len(trim(L#))=0,K#,L#)"/>
      <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
      <RATE COLUMNREFERENCE="P"/>
      <DISCOUNT COLUMNREFERENCE="Q"/>
      <AMOUNT FORMULA="=Round(R#,2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
      <ACTUALQTY COLUMNREFERENCE="O"/>
      <BILLEDQTY COLUMNREFERENCE="O"/>
      <ACCOUNTINGALLOCATIONS.LIST>
        <LEDGERNAME FORMULA="=if(len(trim(AB#))&gt;0,AB#,if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;debit note&quot;),&quot;PURCHASE &quot;,&quot;SALES &quot;) &amp; (V#+X#+Z#) &amp; &quot;%&quot;)"/>
        <ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
        <AMOUNT FORMULA="=Round(R#,2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
      </ACCOUNTINGALLOCATIONS.LIST>
      <BATCHALLOCATIONS.LIST>
        <GODOWNNAME>Main Location</GODOWNNAME>
        <BATCHNAME>Primary Batch</BATCHNAME>
        <DESTINATIONGODOWNNAME>Main Location</DESTINATIONGODOWNNAME>
        <AMOUNT FORMULA="=Round(R#,2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
        <ACTUALQTY COLUMNREFERENCE="O"/>
        <BILLEDQTY COLUMNREFERENCE="O"/>
      </BATCHALLOCATIONS.LIST>
      <UDF:EIDISCOUNTRATE.LIST SKIP="=Round(S#,2)=0" DESC="`EI DiscountRate`" ISLIST="YES" TYPE="Number" INDEX="10001">
        <UDF:EIDISCOUNTRATE DESC="`EI DiscountRate`" COLUMNREFERENCE="S"/>
      </UDF:EIDISCOUNTRATE.LIST>
      <UDF:EIDISCOUNTAMT.LIST SKIP="=Round(T#,2)=0" DESC="`EI DiscountAmt`" ISLIST="YES" TYPE="Amount" INDEX="10003">
        <UDF:EIDISCOUNTAMT DESC="`EI DiscountAmt`" COLUMNREFERENCE="T"/>
      </UDF:EIDISCOUNTAMT.LIST>
    </ALLINVENTORYENTRIES.LIST>
  </VOUCHER9>
</XMLTAGS>

