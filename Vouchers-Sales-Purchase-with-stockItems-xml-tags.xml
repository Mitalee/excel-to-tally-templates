<!-- These XML tags are added to Excel sheet at run-time by UDIMAGIC  -->
<XMLTAGS CELLREFERENCE="A1" xmlns:UDF="TallyUDF">
	<!-- Specifies that this (i.e Column as mentioned above) is the key field -->
	<COLUMNNAME.LIST>
		<COLUMNNAME>ID</COLUMNNAME>
		<COLUMNNAME>NAME</COLUMNNAME>
	</COLUMNNAME.LIST>
	<!-- Create VOUCHERTYPE Master -->
	<MASTER TYPE="VOUCHERTYPE">
		<NAME.LIST TYPE="String">
			<NAME COLUMNREFERENCE="C"/>
		</NAME.LIST>
		<PARENT COLUMNREFERENCE="B"/>
		<MAILINGNAME FORMULA="=if(lower(trim(B#))=&quot;purchase&quot;,&quot;Purc&quot;,&quot;Sale&quot;)"/>
		<NUMBERINGMETHOD>Manual</NUMBERINGMETHOD>
		<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),&quot;No&quot;,&quot;Yes&quot;)"/>
	</MASTER>	
	<!-- Create LEDGER Masters -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="H"/>
		</NAME.LIST>
		<PARENT FORMULA="=if(lower(trim(B#))=&quot;purchase&quot;,&quot;Sundry Creditors&quot;,&quot;Sundry Debtors&quot;)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
	</MASTER>
	<!-- Create a single LEDGER Master -->
	<MASTER TYPE="LEDGER" SINGLERECORD="Yes">
		<NAME.LIST>
			<NAME>Purchase</NAME>
		</NAME.LIST>
		<PARENT>Purchase Accounts</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>Yes</AFFECTSSTOCK>
	</MASTER>
	<!-- Create a single LEDGER Master -->
	<MASTER TYPE="LEDGER" SINGLERECORD="Yes">
		<NAME.LIST>
			<NAME>Sales</NAME>
		</NAME.LIST>
		<PARENT>Sales Accounts</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>Yes</AFFECTSSTOCK>
	</MASTER>
	<!-- Create Purchase LEDGER Masters -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="N"/>
		</NAME.LIST>
		<PARENT FORMULA="=if(Or(lower(trim(B#))=&quot;purchase&quot;,lower(trim(B#))=&quot;credit note&quot;),&quot;Purchase Accounts&quot;,&quot;Sales Accounts&quot;)"/>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>Yes</AFFECTSSTOCK>
	</MASTER>
	<!-- Create Ledger1 Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="O"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Create Ledger2 Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="Q"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Create Ledger3 Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="S"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Create Ledger4 Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="U"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>
	<!-- Create Ledger5 Master -->
	<MASTER TYPE="LEDGER">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="W"/>
		</NAME.LIST>
		<PARENT>Indirect Expenses</PARENT>
		<ISCOSTCENTRESON>No</ISCOSTCENTRESON>
		<AFFECTSSTOCK>No</AFFECTSSTOCK>
	</MASTER>

	<!-- Create UNIT Master -->
	<MASTER TYPE="UNIT">
		<NAME COLUMNREFERENCE="J"/>
		<ISSIMPLEUNIT>Yes</ISSIMPLEUNIT>
	</MASTER>
	<!-- Create STOCKITEM Masters -->
	<MASTER TYPE="STOCKITEM">
		<NAME.LIST>
			<NAME COLUMNREFERENCE="I"/>
		</NAME.LIST>
		<PARENT/>
		<BASEUNITS COLUMNREFERENCE="J"/>
	</MASTER>
	<VOUCHER>
		<GUID FORMULA="=+&quot;udi-HC6KQ9-&quot; &amp; A# &amp; &quot;-&quot; &amp; B# &amp; &quot;-&quot; &amp; D# &amp; &quot;-&quot; &amp; E#"/>
		<DATE COLUMNREFERENCE="E"/>
		<EFFECTIVEDATE COLUMNREFERENCE="E"/>
		<VOUCHERTYPENAME COLUMNREFERENCE="C"/>
		<VOUCHERNUMBER COLUMNREFERENCE="D"/>
		<REFERENCE COLUMNREFERENCE="F"/>
		<NARRATION COLUMNREFERENCE="Y"/>
		<ISINVOICE>Yes</ISINVOICE>
		<!-- For Purchase -->
		<REFERENCEDATE COLUMNREFERENCE="G"/>
		<!-- Party Ledger to be credited -->
		<LEDGERENTRIES.LIST>
			<LEDGERNAME COLUMNREFERENCE="H"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;No&quot;,&quot;Yes&quot;)"/>
			<AMOUNT FORMULA="={Round(M#,2)+Round(P#,2)+Round(R#,2)+Round(T#,2)+Round(V#,2)+Round(X#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),1,-1)"/>
			<BILLALLOCATIONS.LIST SKIP="=Len(trim(D#))=0">
				<NAME COLUMNREFERENCE="D"/>
				<BILLTYPE>New Ref</BILLTYPE>
				<AMOUNT FORMULA="={Round(M#,2)+Round(P#,2)+Round(R#,2)+Round(T#,2)+Round(V#,2)+Round(X#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),1,-1)"/>
			</BILLALLOCATIONS.LIST>
		</LEDGERENTRIES.LIST>
		
		<!-- Ledger1 -->
		<LEDGERENTRIES.LIST SKIP="={Round(P#,2)}=0">
			<LEDGERNAME COLUMNREFERENCE="O"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT FORMULA="={Round(P#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
		</LEDGERENTRIES.LIST>		
		<!-- Ledger2 -->
		<LEDGERENTRIES.LIST SKIP="={Round(R#,2)}=0">
			<LEDGERNAME COLUMNREFERENCE="Q"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT FORMULA="={Round(R#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
		</LEDGERENTRIES.LIST>		
		<!-- Ledger3 -->
		<LEDGERENTRIES.LIST SKIP="={Round(T#,2)}=0">
			<LEDGERNAME COLUMNREFERENCE="S"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT FORMULA="={Round(T#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
		</LEDGERENTRIES.LIST>		
		<!-- Ledger4 -->
		<LEDGERENTRIES.LIST SKIP="={Round(V#,2)}=0">
			<LEDGERNAME COLUMNREFERENCE="U"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT FORMULA="={Round(V#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
		</LEDGERENTRIES.LIST>		
		<!-- Ledger5 -->
		<LEDGERENTRIES.LIST SKIP="={Round(X#,2)}=0">
			<LEDGERNAME COLUMNREFERENCE="W"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
			<AMOUNT FORMULA="={Round(X#,2)}*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
		</LEDGERENTRIES.LIST>		
		
		<ALLINVENTORYENTRIES.LIST SCROLL="YES" SKIP="=Len(trim(I#))=0">
			<STOCKITEMNAME COLUMNREFERENCE="I"/>
			<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
			<RATE COLUMNREFERENCE="L"/>
			<AMOUNT FORMULA="=Round(M#,2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
			<ACTUALQTY COLUMNREFERENCE="K"/>
			<BILLEDQTY COLUMNREFERENCE="K"/>
			<ACCOUNTINGALLOCATIONS.LIST>
				<!-- Purchase and Debit note will be Purchase Ledger -->
				<LEDGERNAME FORMULA="=If(Len(trim(N#))=0,if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;debit note&quot;),&quot;Purchase&quot;,&quot;Sales&quot;),N#)"/>
				<ISDEEMEDPOSITIVE FORMULA="=if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),&quot;Yes&quot;,&quot;No&quot;)"/>
				<AMOUNT FORMULA="=Round(M#,2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
			</ACCOUNTINGALLOCATIONS.LIST>
			<BATCHALLOCATIONS.LIST>
				<GODOWNNAME>Main Location</GODOWNNAME>
				<BATCHNAME>Primary Batch</BATCHNAME>
				<DESTINATIONGODOWNNAME>Main Location</DESTINATIONGODOWNNAME>
				<AMOUNT FORMULA="=Round(M#,2)*if(Or(lower(trim(B#[1]))=&quot;purchase&quot;,lower(trim(B#[1]))=&quot;credit note&quot;),-1,1)"/>
				<ACTUALQTY COLUMNREFERENCE="K"/>
				<BILLEDQTY COLUMNREFERENCE="K"/>
			</BATCHALLOCATIONS.LIST>
		</ALLINVENTORYENTRIES.LIST>
	</VOUCHER>
</XMLTAGS>

